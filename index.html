<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Jadwal Peminjaman Inventaris</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
      background: transparent; /* biar ikut background Google Sites */
      color: white; /* default warna teks putih */
    }

    body {
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .table-wrapper {
      width: 100%;
      height: 100%;
      overflow: auto;
    }

    table {
      border-collapse: collapse;
      font-size: 16px;
      min-width: 600px;
      width: 100%;
      border-radius: 12px;
      overflow: hidden;
    }

    th, td {
      padding: 12px 16px;
      text-align: center;
      white-space: nowrap;
    }

    /* Header tetap biru */
    th {
      background: linear-gradient(135deg, #1565c0, #1e88e5);
      color: white;
      font-weight: 600;
    }

    /* Isi tabel transparan, garis putih, teks putih */
    td {
      border: 1px solid white;
      background: transparent;
      color: white;
    }

    tr:hover td {
      background: rgba(255,255,255,0.1); /* efek hover samar */
      transition: background 0.3s ease;
    }
  </style>
</head>
<body>
  <div class="table-wrapper">
    <table id="tabelPeminjaman" style="display:none;">
      <thead></thead>
      <tbody></tbody>
    </table>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script>
    const sheetUrlBase = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTOLUt0zZWTsJ8PJh5py8vgf-yDdjcZPqLlZhGROIavVZ3XDamZp4AKVtKx1cAFJOx3o0AcBCkHNmiA/pub?gid=0&single=true&output=csv";

    function loadData(retry = 0) {
      const url = sheetUrlBase + "&t=" + new Date().getTime();
      Papa.parse(url, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          const table = document.getElementById("tabelPeminjaman");
          const thead = table.querySelector("thead");
          const tbody = table.querySelector("tbody");

          thead.innerHTML = "";
          tbody.innerHTML = "";

          if (!results.data || results.data.length === 0) {
            if (retry < 3) {
              setTimeout(() => loadData(retry + 1), 1000);
            }
            return;
          }

          // header otomatis
          const headerRow = document.createElement("tr");
          Object.keys(results.data[0]).forEach(col => {
            const th = document.createElement("th");
            th.textContent = col;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);

          // isi data
          results.data.forEach(row => {
            const tr = document.createElement("tr");
            Object.values(row).forEach(val => {
              const td = document.createElement("td");
              td.textContent = val;
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });

          table.style.display = "table";
        }
      });
    }

    loadData();
    setInterval(loadData, 10000);
  </script>
</body>
</html>
